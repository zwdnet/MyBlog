---
title: '量化投资学习笔记63——CFA一级笔记02:定量方法(Quantitative Methods)：描述统计学'
date: 2020-06-12 09:22:25
tags: [量化投资, CFA, 学习笔记]
categories: 量化投资
---

学习目标：货币的时间价值、数据收集及分析、基础统计学、概率论、概率分布理论在金融决策制定中的应用。
Reading 6 货币的时间价值(The Time Value of Money)
货币的时间价值指现在的少量钱与未来的更多量的钱的价值相等。这个概念主要处理不同时间的现金流的关系。
利率(Interest rates)
利率是反映不同日期的现金流的关系的量。现在付出9500一年后收到10000，利率为500/9500=0.0526=5.26%。
可以从三个层面理解：首先利率是投资者接受一个投资所能接受的最小收益率；其次，利率可以看做是未来货币对现在的折扣率；第三，利率可以看成是机会成本。即投资者放弃某项选择的成本。
经济学家认为利率是债券市场供需决定的。可以将利率看成由无风险利率和其它四个成分组成的。
r = 无风险利率+通货膨胀率+违约风险溢价+流动性溢价+到期风险溢价
无风险利率(real risk-free interest rate)：指不考虑通胀因素的完全无风险债券的单期利率。反映了个人对当期消费和延期消费的不同选择的时间偏好(time preferences)。
通胀率（inflation premium）：对于预期通胀给投资者的补偿，并反映了超过到期债务的平均通胀率的预期。通胀降低了单位货币的购买力。无风险利率和通胀率之和称为名义无风险利率（nominal risk-free interest rate）。一些国家的政府短期债券的利率可以认为代表了名义无风险利率，如90天美国国债。
违约风险溢价（default risk premium）：为补偿债务人可能到期违约的风险的收益。违约风险越大利率越高。
流动性溢价（liquidity premium）：为了投资者可能因为需要快速赎回部分现金所带来的价值损失。（即流动性差的债券，其利率要比流动性好的债券——如美国国债——高一些。）
到期风险溢价（maturity premium）：补偿投资者持有较长期限的债券的敏感性。（即期限长的债券比期限短的债券的年化利率高出来的部分，存10年的利率要比存1年存10次的利率高。）
单笔现金流的未来价值：讨论初始投资(现值,present value, PV)与单位时间内取得的收益率(rate, r)和其N年或N期后的终值(future value, FV)的关系。
FV1 = PV(1+r)
FV2 = FV1(1+r) = PV(1+r)^2
FVN = PV(1+r)^N
这里的利息称为本金(Principal)的简单利息(本金乘以利率)。其中利率r应该是一个时间周期的利率。
这就是复利现象，即用得到的利息再投资。
计息频率:计息周期可以低于一年，比如每月计息。常用的概念有名义年利率(stated annual interest rate,rs)或票面利率(quoted interest rate)。等于月利率乘以12。
对于一年有m期的计息，公式为
FVN = PV(1+rs/m)^mN
对于分期m趋于无穷小的时候，
FVN = PVe^(rsN)
年利率8%按半年计息能得到8.16%的利息，这就是名义年利率与有效年利率(effective annual rate， EAR)的区别。
EAR = (1+一个m周期的利率)^m-1=e^rs-1
一系列现金流的未来价值
与多个时间周期的现金估值有关的概念。①年金(annuity)，是一个无限的定期现金流的集合。②普通年金(ordinary annuity):从现在开始第一个周期即有第一次现金流。③期初应付年金(annuity due):会立即产生的现金流。④永续年金(perpetuity)，一个无穷的现金流序列，从现在开始一个周期后开始。
普通年金:相等的现金流。
FVN = A[(1+r)^N - 1]/r
不相等的现金流。每期单独算再加起来。
单笔现金流的现值。
PV = FVN(1+r)^-N
对于一年内大于一次的复利周期，有
PV = FVN(1+rs/m)^(-mN)
其中rs为年利率。
系列现金流的现值。可以是非常不同，相对相似和完全相同的现金流。时间也可以或长或短甚至是无期限的。
一系列相等现金流的现值。
PV = A/(1+r) + A/(1+r)^2 + …… + A/(1+r)^N
其中A为年金总额。
无限期的等量现金流的现值:PV = A/r
金额不相等的现金流的现值，挨个计算喽。
计算年金的利率，期数，偿还大小。就是上述公式的变换啦。
![](https://zymblog-1258069789.cos.ap-chengdu.myqcloud.com/blog0178-QTLearn/42/01.png)
Reading 7 统计学概念和市场收益(Statistical Concepts and Market Returns)
一些基本概念
统计学有数据和方法两个含义。统计方法分为统计描述和统计推断。统计描述将数据转化为信息。统计推断利用小样本的数据对总体数据进行预测，推断和判断。其基础是概率论。
总体是研究的问题的所有元素的集合，用参数来描述总体，如平均值，标准差等。我们常常不能直接研究总体。
样本是总体的一个子集。采样时希望样本具有代表性。样本的统计参数代表了样本的特征。统计推断是用样本的统计值去推测总体参数。
有四种不同的数据类型:定距型数据（Interval Scale）、定序型数据（Ordinal Scale）、定类型数据（Nominal Scale）和定比型数据 (Ratio Scale)。
频率分布:将数据转换成为较小的区间的表格。
持有期回报(Holding Period Return Formula)Rt = (Pt - Pt-1 + Dt)/Pt-1 ，其中Pt为周期t后的每股价格，Pt-1为周期t-1的每股价格，Dt为t-1到t之间的现金分红。
建立一个频率分布的步骤：
①将数据按升序排序。
②计算数据的范围，定义为范围=最大值-最小值。
③确定将数据划分为k个区间。
④确定区间宽度 = 范围/k
⑤用最小值+区间宽度，确定每个区间的止点。
⑥计数每个区间内数据的个数。
⑦建立一个表格，从小到大列出每个区间内数据的出现频数。
用python可以做的。
```python
import pandas as pd

mydata = {"Nations":["a", "b", "c", "d", "e", "f", "g",
"h", "i", "j", "k", "l", "m", "n", "o", "p", "q", "r", "s"],
"Returns":[8.3, 5,3, 7.1, 7.4, 9.3, 5.8, 8.2, 7.0, 6.0, 8.8, 7.2,
8.0, 7.3, 9.4, 5.8, 8.0, 6.3, 7.3]}
# print(mydata, len(mydata), len(mydata["Nations"]), len(mydata["Returns"]))
data = pd.DataFrame(mydata)
print(data.describe())
data.index.name = "Nations"
data.columns = ["Nations", "Returns"]
print(data.head())
returns = data.Returns
fanwei = list(range(5, 11, 1))
fenzu = pd.cut(returns.values, fanwei, right = False)
print(fenzu.codes)
print(fenzu.categories)
pinshu = fenzu.value_counts()
print(pinshu.index)
qujian = pd.cut(returns, fanwei, right=False)
data["区间"] = qujian.values
data.groupby("区间").median()
data.groupby("区间").mean()
pinshu_df = pd.DataFrame(pinshu, columns = ["频数"])
pinshu_df["频率f"] = pinshu_df/pinshu_df["频数"].sum()
pinshu_df["频率%"] = pinshu_df["频率f"].map(lambda x: "%.2f%%"%(x*100))
pinshu_df["累计频率f"] = pinshu_df["频率f"].cumsum()
pinshu_df["累计频率%"] = pinshu_df["累计频率f"].map(lambda x:"%.4f%%"%(x*100))
print(pinshu_df)
```
结果
![](https://zymblog-1258069789.cos.ap-chengdu.myqcloud.com/blog0178-QTLearn/42/02.png)
用图形来呈现数据
直方图、频率曲线和累积频率曲线。
衡量集中趋势
算术均数=数据总和/总体或样本总数。
算术均数的性质，所有数与均数只差的总和为0。
中位数:位于中间位置的数。对比平均数，其优势是极端值不会影响中位数。
众数(the mode):出现频率最高的数。如果没有两个数是相同的，则没有众数。但有的区间内的数据个数可能比其它区间多，叫众区间(mode interval)。
加权平均数:考虑数据权重的平均数。
几何平均数：最常用于随时间变化的平均率或计算变量的增长率。在投资中常用于计算一个收益率的时间序列。或收入、销售量等金融变量的增长率。
一个例子：股票购买价格是100元，一年后，股票的交易价格是200元。第二年末，股票的价格又跌到100元。没有股息。计算算术年收益率和几何年收益率。
第一年的收益率：200/100 - 1 = 100%
第二年的收益率：100/200 - 1 = -50%
算术年化收益率：(100%-50%)/2 = 25%
几何年化收益率：要先把收益率转换成(1+Rt）的形式，然后计算得到:sqrt(2.0×0.50) - 1 = 0。
因此几何年化收益率更能反映真实收益情况。
调和平均数(harmonic mean)：用得较少。
其它描述位置的方法：分位数。包括四分位数、五分位数、十分位数、百分位数等。
测量离散度
测量绝对离散度（absolute dispersion，不借助任何参考点的变量的离散程度）的指标：范围、均差(mean absolute deviation)、方差、标准差。
范围 = 最大值-最小值
均差 = 每个变量取值与算术均值的查的绝对值的算术均值。
总体方差=每个值与总体均值的差的平方的算术均值。
总体标准差=总体方差开平方。
样本方差和标准差：计算算术均值的时候用(n-1)代替n。
半方差和半标准差：计算的时候只考虑小于总体/样本均值的值。
切比雪夫不等式(Chebyshev’s Inequality)：任意一个数据集中，位于其平均数m个标准差范围内的比例（或部分）总是至少为1-1/m^2，k>1。
对于m=2,3,5有如下结果：
所有数据中，至少有3/4的数据位于平均数2个标准差范围内。至少有8/9的数据位于平均数3个标准差范围内，至少有24/25的数据位于平均数5个标准差范围内。(这段抄百度百科了）
度量相对离散程度(有一个参考点)
变异系数（Coefficient of Variation）= 样本标准差/样本平均数
收益的对称(symmetry）和不对称(skewness）分布。最重要的对称分布是正态分布，其平均值和中位数相等，能由两个参数——均值和方差——完全描述，大约有68的数据在正负一个标准差的范围内，95%的数据在正负两个标准差范围内，99%的数据在正负三个标准差范围内。不是对称分布的称为非对称分布，正的非对称分布意味着损失较小并有额外收益。衡量偏离程度用偏度(skewness)。
峰度（KURTOSIS）表征概率密度分布曲线在平均值处峰值高低的特征数。直观看来，峰度反映了峰部的尖度。峰度高就意味着方差增大是由低频度的大于或小于平均值的极端差值引起的。（这段也是抄自百度百科）具体计算略了。
![](https://zymblog-1258069789.cos.ap-chengdu.myqcloud.com/blog0178-QTLearn/42/03.png)

Reading 8概率论概念(probability concepts)
随机变量:取值不确定的变量。
事件:一组特别的结果。
概率:代表某组事件发生的可能性的数字，取值范围[0，1]。一组互斥不相容的事件的概率之和为1。
概率分为经验概率(empirical probability),主观概率(subjective probability),先验概率(priori probability)。先验概率和经验概率又称客观概率。概率又可分为非条件概率和条件概率。
联合概率:多个事件同时发生的概率。
条件概率公式: P(A|B) = P(AB)/P(B)
概率乘法公式:P(AB) = P(A|B)P(B)
概率加法公式:P(A or B) = P(A) + P(B) – P(AB)
独立事件的定义:P(A|B)=P(A)
独立事件乘法公式:P(AB)=P(A)P(B)
全概率公式: P(A)=P(A|B1)P(B1) + P(A|B2)P(B2) + ... + P(A|Bn)P(Bn)。B1,B2,…Bn为完备事件组。(抄百度百科)
随机变量的期望值:随机变量以概率值为权重的加权平均数。
随机变量的方差=E{[X-E(X)]^2}
投资组合的期望收益和收益的方差
设想一个投资组合，标普500指数基金50%，预期收益13%;美国长期国债25%，预期收益6%;全球市场基金25%，预期收益15%。
投资组合的期望收益为:0.5×0.13+0.25×0.06+0.25×0.15=11.75%
两个随机变量Ri和Rj的协方差(Covariance)为
Cov(Ri, Rj) = E[(Ri-ERi)(Rj-ERj)]
可以用样本历史数据来估计，公式略。
随机变量的方差=ΣiΣjwiwjCov(Ri, Rj)
对于一个随机变量自身，Cov(R,R) = R的方差。
计算上述投资组合的协方差矩阵为:
![](https://zymblog-1258069789.cos.ap-chengdu.myqcloud.com/blog0178-QTLearn/42/04.png)
据此可以计算随机变量的方差。进而求出组合的标准差为14%。当几个投资品相关性越小时，组合的收益方差也越小，而预期收益保持不变。这就是投资组合理论的关键。
Ri,Rj的相关系数ρ(Ri,Rj) = Cov(Ri,Rj)/[σ(Ri)σ(Rj)]
上述投资组合的相关系数矩阵
![](https://zymblog-1258069789.cos.ap-chengdu.myqcloud.com/blog0178-QTLearn/42/05.png)
相关系数取值在[-1,1]，0表示完全没关系，-1为完全负相关，1为完全正相关。
可以用散点图绘出变量之间的关系。
局限:两个变量可能有很强的非线性关系，但相关系数非常低。
贝叶斯公式
是我们遇到新信息时调整自己观点的理性方法。贝叶斯公式来自于全概率公式。给定一组我们关心的事件的先验概率。如果遇到新的信息，按照下述公式更新关于该事件的概率=(给定事件的新信息的概率/新信息的非条件概率)×事件的先验概率
P(事件|信息) = [P(信息|事件)/P(信息)]×P(事件)
更新后的概率称为后验概率。
计数原理
乘法原理:分步，每步的做法总数相乘。
加法原理:分类，每类的做法相加。
排列组合。从个元素中选出k个，组合顺序不重要。排列顺序很重要。
nCr = n!/[(n-r)!r!]
nPr = n!/(n-r)!
选择计数方法要考虑的问题:
①要解决的问题需要有有限的结果。
②是否需要考虑所有n个元素?是的话用阶乘。
③是否需要分步解决?是的话用乘法原理。
④是否需要从n个元素中选出r个，且顺序不重要。是的话用组合公式。
⑤是否需要从n个元素中选出r个，且顺序很重要。是的话用排列公式。
⑥能否使用计数的乘法原理?如果不能，可能只能一个一个数，或使用更高级的工具了。
![](https://zymblog-1258069789.cos.ap-chengdu.myqcloud.com/blog0178-QTLearn/42/06.png)



我发文章的三个地方，欢迎大家在朋友圈等地方分享，欢迎点“在看”。
我的个人博客地址：https://zwdnet.github.io
我的知乎文章地址： https://www.zhihu.com/people/zhao-you-min/posts
我的微信个人订阅号：赵瑜敏的口腔医学学习园地


![](https://zymblog-1258069789.cos.ap-chengdu.myqcloud.com/other/wx.jpg)