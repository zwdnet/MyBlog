---
title: 量化投资学习笔记06——《打开量化投资的黑箱》读书笔记
date: 2020-01-05 10:37:06
tags: [量化投资,pyalgotrade,读书笔记,学习笔记]
categories: 量化投资
---
读了一本量化投资的书，笔记如下。
书名：打开量化投资的黑箱
作者：Rishi K. Narang
译者：郭建光
出版者：机械工业出版社
版次：2012年3月第一版第一刷
前言
量化交易是人类经过严格研究后得到的交易策略，然后交付给系统去实施。其与主观判断型的交易策略的主要差别在于策略如何生成及如何实施。
阿尔法策略通过择时和调整投资组合中不同头寸的大小来获得回报。贝塔策略复制指数或略微超出指数表现。
第一部分 量化交易的世界
第1章 我们为何关注量化交易
能够从宽客身上学到的:强制自己对所采用的投资策略的各个方面做出更深入的思考。对纪律的严格遵守。
第2章 量化交易简介
优秀宽客和平庸宽客的区别就在于是否具有良好判断。当出现了模型所不能处理的驱动市场变化的信息时，需要人工干预策略执行。
量化交易系统是如何构成的?
由阿尔法模型，风险控制模型，成本控制模型形成投资组合构建模型，并形成执行模型。模型的构建和执行还必须有高质量的数据。
第二部分 打开黑箱
第3章 α模型:宽客如何赚钱?
α指投资者获得的与市场波动无关的回报。指宽客为了获利而在投资过程中表现出来的技巧。追求阿尔法回报的策略，本质上就是投资组合的资产配置决策及设置其头寸规模的择时决策。其核心思想:没有永远好或永远差的金融产品。关键因素是决定何时持多和持空。价值型投资背后的思想是，在股价低估时买入而在股价高估时卖出。任何行之有效的阿尔法模型都有其适用范围。理解宽客最关键的一点是明白其如何科学地思考问题。阿尔法模型分理论驱动和数据驱动两类。绝大多数理论驱动型宽客可以分为五大类:趋势型、恢复型、价值型/收益型、成长型、品质型。数据分为价格相关数据和基本面数据。数据驱动模型的假设是数据可以暗示将要发生的事，并且借助分析技术可以识别出一些市场走势。优点是可以知其然不知其所以然，用的人较少。缺点是计算量可能超出能接受的范围，另外依赖于历史数据，需要不断调整。输入数据中的噪声很大可能产生错误信号。宽客实施策略的差异包括预期目标(模型到底要预测什么)、投资期限(高频、中线、长线)、投注结构、投资范围、模型设置、运行频率。将各种阿尔法策略混合，常采用线性模型，非线性模型和机器学习模型等方法。
第4章 风险控制模型
风险管理是为了提高回报的质量和持续性，而对敞口实施有目的的选择和规模控制。量化交易的一个巨大优势就是能够度量各种不同的敞口，并且对于这些敞口的选择是有目的的。其希望识别出可以承担哪种系统性风险，度量投资组合中每种敞口的大小，然后决定这些风险是否可以接受。
第5章 交易成本模型
背后的思想:任何交易都要花费成本。交易成本占了回报的20%-50%。交易的两个理由:提高回报，降低损失。但交易对其的微小改进，可能覆盖不了交易成本。交易成本模型并不是用来最小化交易成本的，而只是用来确定模型所需要的交易成本。交易成本的组成:佣金、滑点(指的是交易者在决定交易开始到订单实际上被执行这两个时间段之间的价格变化)、市场冲击(交易者的订单对市场的影响)。趋势跟随策略对滑点比较敏感。
交易成本模型的类型:常数交易成本模型、线性交易成本模型、分段线性交易成本模型、二次型交易成本模型。
第6章 投资组合构建模型
目标是决定宽客将要持有的投资组合。有两类方式，一类是基于规则，另一类采用最优化工具。
基于规则的投资组合构建模型:相等头寸权重、相等风险权重、阿尔法驱动的权重、决策树权重。它们的共同挑战都是如何解释驱动它们背后的经济原理和规则的合理性。
投资组合最优化工具:需要输入期望回报、期望波动率、期望相关性。常用最优化工具:无约束条件的最优化、有约束条件的最优化、布莱克-莱特曼最优化方法、格里诺德-卡恩方法:最优化因素投资组合、重新取样、基于数据挖掘的最优化方法。输出为目标投资组合。
第7章 执行模型
交易方式:电子化交易或通过人工。
订单执行算法有市价订单和限价订单两类。订单有不同的执行方式。要决定是消极被动还是积极主动行事。大订单可以拆分成小订单执行。
第8章 数据
系统的输入从本质上决定了你能用这个系统做什么。基本数据类型分为价格相关数据和基本面数据。处理缺失数据:使用最近的已知数据，或插入合理数值。处理错误数据，如进制错误(元被当成分)，使用奇异点过滤器等。前视偏差，即使用未来数据。
第9章 研究
研究的目的是审查经过深思熟虑的投资策略。表现良好的量化投资策略的共同特征是在研究中坚持科学研究方法。不同之处是量化策略更不稳定，需要持续修改，更新。
思想的来源:市场观察，文献，向其它量化交易者学习，主观判断型交易者的教训。检验过程对研究至关重要。在量化交易中，模型是世界的近似。检验过程的第一步是用样本内数据来训练模型以找到最优参数。研究的过程中有各种各样的陷阱要避免。要对假设进行检验。
第三部分 量化交易策略的投资指引
第10章 量化交易策略的固有风险
模型风险:建模的不适合性、模型的错误设置、执行错误。
市场逻辑变更风险
外部冲击风险
扩散风险或同质投资者风险
第11章 对量化交易的批评——确保如实记录
交易是艺术而不是科学:人的行为是可以模型化的。
由于低估风险，宽客引发了更多的市场动荡:量化交易诞生之前的市场动荡并不小。
宽客无法处理市场行情中的非常规事件以及快速的变化。
宽客们拥有相同的交易行为。
长期中仅有少数规模庞大的量化基金才能兴旺发展:管理庞大的资金量并非总是件好事。
量化投资中存在数据挖掘过失:过度拟合的问题。当模型复杂度既定时，可供使用的数据越多，出现过拟合问题的可能性越小。对长期投资，使用数据挖掘进行投资决策不太可行。
第12章 评价宽客和量化交易策略
很多量化交易的技术来自于经验和诀窍，而不是来自数学的优势。
评价一个宽客要尽可能了解他所建立的策略。
投资者的优势更多的是内在的或绝对的，而不是表现为比较优势上的。处理逆境的正确方法，首先要有好的监测工具。
第13章 展望量化投资的未来
略
总结：量化交易的“黑箱”主要分为阿尔法模型、风险控制、成本控制三个部分。阿尔法模型是量化投资能赚钱的根本，分为理论驱动和数据驱动型，前者分为趋势型、恢复型、价值型/收益型、成长型、品质型。数据驱动模型的假设是数据可以暗示将要发生的事，并且借助分析技术可以识别出一些市场走势。量化交易的一个巨大优势就是能够度量各种不同的敞口，并且对于这些敞口的选择是有目的的。交易成本占了回报的20%-50%。交易成本的组成:佣金、滑点(指的是交易者在决定交易开始到订单实际上被执行这两个时间段之间的价格变化)、市场冲击(交易者的订单对市场的影响)。量化交易者将上述三个部分组合起来形成自己的量化交易模型，经过回测检验后，付诸实施。量化交易者通过自己研究，向其它同行学习，从文献中学习来获取量化交易策略的思想。量化交易也不是万能的，存在其自身的风险和问题。

另外继续试验了一下pyalgotrade框架的买卖的功能，主要有marketOrder/limitOrder和enterLong/enterShort/enterLongLimit/enterShortLimig两类。enterLong以市价（下一个Bar的开盘价）买入，enterLongLimit当市价（下一个Bar的开盘价）低于或等于指定价格时买入，enterShort和enterShortLimit是卖出。以enter开头是更加上层的方法，建议使用。goodTillCanceled为了适配实盘接口, 实盘接口可能有前一天的订单不会再执行的限制，所以设置goodTillCanceled=True保证第二天或者更后的时间，订单依然有效，直至手动取消。
(上文参考了： https://blog.51cto.com/youerning/2162751 特此感谢！）
用pyalgotrade文档里的homework来做例子测试，结果如下：
![](https://zymblog-1258069789.cos.ap-chengdu.myqcloud.com/blog0178-QTLearn/06/01.png)
前一个是用marketOrder下的单，后一个用的是enterLong下的单，都只在__init__里下单，然后就一直持有，可以看到两种下单方式最后的收益还是有细微差别的。用enterLong的好处是可以返回一个position对象，然后就可以输出各种交易信息。另外看了一下原始数据，是用Adj.Open，即复权后的开盘价来买入的。能不能用收盘价之类的进行交易呢？
接下来我打算找本实操的书，照着练吧。
本次的代码在 https://github.com/zwdnet/MyQuant/tree/master/06

我发文章的三个地方，欢迎大家在朋友圈等地方分享，欢迎点“在看”。
我的个人博客地址：https://zwdnet.github.io
我的知乎文章首页： https://www.zhihu.com/people/zhao-you-min/posts
我的博客园博客地址： https://www.cnblogs.com/zwdnet/
我的微信个人订阅号：赵瑜敏的口腔医学学习园地

![](https://zymblog-1258069789.cos.ap-chengdu.myqcloud.com/other/wx.jpg)